<html>

<head>

<link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@200&display=swap" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>

<script src = "population.js"> </script>

<style>

#tabledata
{
  width:800px;
  height:230px;
  background-color:lightblue;
  display:flex;
  flex-direction:column;
}

.countries
{
  width: 50px;
  margin-right:38px;
}

h2
{
  margin:auto;
  width:450px;
  margin-bottom:10px;
}

tr:hover
{
  background-color:#adb8c9;
}

.each:hover
{
  background-color:#768191;
}

th:hover
{
  cursor: pointer;
}

.
{

}


</style>

<body>
  <title> Covid 19 Daily Case Tracker
  </title>

<div ng-app = "covidstats">

 <h2> Covclass 19 Daily Case Tracker </h2>
 <div ng-controller = "insertData">
   <table class="table table-hover table-striped table-bordered">
    <thead>
      <tr>
        <th class = "each" ng-click = "sortBy('Country')" scope="col">Country <span class = "upAndDown"> &#8593&#8595 </span> </th>
        <th class = "each" ng-click = "sortBy('NewConfirmed')" scope="col">Daily Covclass Cases <span class = "upAndDown"> &#8593&#8595 </span> </th>
        <th class = "each" ng-click = "sortBy('TotalConfirmed')" scope="col">Total Covclass Cases <span class = "upAndDown"> &#8593&#8595 </span> </th>
        <th class = "each" ng-click = "sortBy('Population')" scope="col">Population <span class = "upAndDown"> &#8593&#8595 </span> </th>
        <th class = "each" ng-click = "sortBy('DailyPercent')" scope="col">Daily Covclass Cases Per Population <span class = "upAndDown"> &#8593&#8595 </span></th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat = "i in countries|orderBy:sortType">
        <td class = "each">{{i.Country}}</td>
        <td class = "each">{{i.NewConfirmed.toLocaleString()}}</td>
        <td class = "each">{{i.TotalConfirmed.toLocaleString()}}</td>
        <td class = "each">{{i.Population.toLocaleString()}}</td>
        <td class = "each">{{i.DailyPercent}}%</td>
      </tr>
     
    </tbody>
   </table>
  </div>
</div>

</body>


<script>

var app = angular.module("covidstats",[]);

app.controller("insertData",function($scope,$http)
{
  $scope.toggleSort = false;

  $scope.deleteCommas = function(text)
  {
    while(text.includes(","))
    {
      text = text.replace(",","");
    }
      return text; 
  }

  $scope.sortBy = function(category)
  {
    if ($scope.toggleSort)
    {
      category = "-" + category;
    }

    $scope.sortType = category;
    $scope.toggleSort = !$scope.toggleSort; 
  }

  $scope.sortType = "-DailyPercent";

  var url = "https://api.covid19api.com/summary";
  var arr = [];

  $http.get(url).then(function success(response)
  {
    $scope.data = response.data;
    $scope.countries = $scope.data.Countries;
    $scope.countries.splice(5,1);
    
    for (var i = 0; i < $scope.countries.length; i++)
    {
      $scope.countries[i]["Population"] = populations[i];
    }

    for (var j = 0; j < $scope.countries.length; j++)
    {
      $scope.percent = $scope.countries[j].NewConfirmed/populations[j]
      $scope.percent*=10000;
      $scope.percent = $scope.percent.toFixed(2);
      $scope.countries[j]["DailyPercent"] = Number($scope.percent);
    }
  },
    function error(response)
    {
      console.log("failed")
    }
  );


});



</script> 

</head>

</html>